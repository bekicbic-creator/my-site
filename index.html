<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pixel Runner ‚Äî —É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è</title>
<style>
  body {
    margin: 0;
    background: #111;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  canvas {
    border: 2px solid #000;
    background: linear-gradient(#7ec8e3, #f6d19c);
    image-rendering: pixelated;
  }
  #info {
    position: absolute;
    top: 10px;
    left: 10px;
    color: white;
    font-family: 'Courier New', monospace;
    font-size: 20px;
  }
  #controls {
    position: absolute;
    bottom: 10px;
    left: 10px;
    color: white;
    font-family: 'Courier New', monospace;
    font-size: 14px;
  }
</style>
</head>
<body>
<canvas id="game" width="900" height="500"></canvas>
<div id="info">üçî –ë—É—Ä–≥–µ—Ä—ã: 0</div>
<div id="controls">–ü–ö ‚Äî –ø—Ä–æ–±–µ–ª, –¢–µ–ª–µ—Ñ–æ–Ω ‚Äî —Ç–∞–ø/–∫–ª–∏–∫</div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let player = { x: 100, y: 400, vy: 0, size: 30, jumping: false, aura: 0 };
let gravity = 0.6;
let jumpPower = -11;
let groundY = 430;
let speed = 5;
let obstacles = [];
let burgers = [];
let score = 0;
let frame = 0;
let gameEnded = false;
let girl = null;

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
document.addEventListener('keydown', e => {
  if (e.code === 'Space') jump();
});
canvas.addEventListener('click', jump);
function jump() {
  if (!player.jumping) {
    player.vy = jumpPower;
    player.jumping = true;
  }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π –∏ –±—É—Ä–≥–µ—Ä–æ–≤
function spawnObstacle() {
  obstacles.push({ x: canvas.width, y: groundY - 25, w: 20 + Math.random() * 15, h: 25 + Math.random() * 10 });
}
function spawnBurger() {
  burgers.push({ x: canvas.width, y: groundY - 80, size: 20 });
}
function spawnGirl() {
  girl = { x: canvas.width, y: groundY - 50, size: 40 };
}

// –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
function drawPlayer() {
  ctx.fillStyle = '#5aa0ff'; // —Ñ—É—Ç–±–æ–ª–∫–∞
  ctx.fillRect(player.x, player.y - player.size, player.size, player.size);
  ctx.fillStyle = '#2e57ff'; // –¥–∂–∏–Ω—Å—ã
  ctx.fillRect(player.x, player.y - 10, player.size, 10);
  ctx.fillStyle = '#8b4513'; // –≤–æ–ª–æ—Å—ã
  ctx.fillRect(player.x + 5, player.y - player.size - 5, 20, 5);

  // –ê—É—Ä–∞
  if (player.aura > 0) {
    ctx.strokeStyle = `rgba(255, 255, 0, ${player.aura / 50})`;
    ctx.beginPath();
    ctx.arc(player.x + 15, player.y - 15, 25, 0, Math.PI * 2);
    ctx.stroke();
    player.aura--;
  }
}

// –†–∏—Å—É–µ–º –¥–µ–≤—É—à–∫—É
function drawGirl() {
  ctx.fillStyle = '#ff5555'; // –ø–ª–∞—Ç—å–µ
  ctx.fillRect(girl.x, girl.y - girl.size, girl.size, girl.size);
  ctx.fillStyle = '#ffdd88'; // –≤–æ–ª–æ—Å—ã
  ctx.fillRect(girl.x + 5, girl.y - girl.size - 8, 30, 8);
}

// –†–∏—Å—É–µ–º —Ñ–æ–Ω
function drawBackground() {
  ctx.fillStyle = '#a85';
  ctx.fillRect(0, groundY, canvas.width, 100);
  ctx.fillStyle = '#5a2';
  obstacles.forEach(o => ctx.fillRect(o.x, o.y - o.h, o.w, o.h));
}

// –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –∏–≥—Ä—ã
function update() {
  if (gameEnded) return;

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawBackground();

  // –î–≤–∏–∂–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
  player.y += player.vy;
  player.vy += gravity;
  if (player.y >= groundY) {
    player.y = groundY;
    player.vy = 0;
    player.jumping = false;
  }

  // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è –∏ –±—É—Ä–≥–µ—Ä—ã
  obstacles.forEach(o => o.x -= speed);
  burgers.forEach(b => b.x -= speed);
  obstacles = obstacles.filter(o => o.x + o.w > 0);
  burgers = burgers.filter(b => b.x + b.size > 0);

  // –°–ø–∞–≤–Ω
  if (frame % 120 === 0 && Math.random() < 0.7) spawnObstacle();
  if (frame % 400 === 0 && Math.random() < 0.5) spawnBurger();
  if (frame === 3500) spawnGirl();

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π
  for (let o of obstacles) {
    if (
      player.x < o.x + o.w &&
      player.x + player.size > o.x &&
      player.y > o.y - o.h
    ) {
      endGame(false);
      return;
    }
  }

  for (let i = burgers.length - 1; i >= 0; i--) {
    let b = burgers[i];
    if (
      player.x < b.x + b.size &&
      player.x + player.size > b.x &&
      player.y - player.size < b.y + b.size
    ) {
      score++;
      player.aura = 50;
      burgers.splice(i, 1);
    }
  }

  if (girl) {
    girl.x -= speed;
    drawGirl();
    if (girl.x < player.x + 20) {
      endGame(true);
    }
  }

  drawPlayer();
  burgers.forEach(b => {
    ctx.fillStyle = '#c93';
    ctx.fillRect(b.x, b.y, b.size, b.size / 3);
    ctx.fillStyle = '#633';
    ctx.fillRect(b.x, b.y + b.size / 3, b.size, b.size / 3);
  });

  document.getElementById('info').innerText = `üçî –ë—É—Ä–≥–µ—Ä—ã: ${score}`;
  frame++;
  requestAnimationFrame(update);
}

function endGame(win) {
  gameEnded = true;
  ctx.fillStyle = 'rgba(0,0,0,0.6)';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = '#fff';
  ctx.font = '30px Courier New';
  if (win) {
    ctx.fillText('üíñ –í—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –¥–µ–≤—É—à–∫—É! –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞ üíñ', 80, 250);
  } else {
    ctx.fillText('üíÄ –í—ã —Å–ø–æ—Ç–∫–Ω—É–ª–∏—Å—å –æ –∫–∞–∫—Ç—É—Å! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞', 60, 250);
  }
}

update();
</script>
</body>
</html>
